{% extends 'faq/base.html' %}

{% block content %}

    <!-- Page Header -->
  <header class="masthead" style="background-image: url('img/home-bg.jpg')">
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="site-heading">
            <h1>Recettes</h1>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Search form -->
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto" >
        <form action="{% url 'recipes:landing' %}" method="post">
          {% csrf_token %}
          <!-- <input type="hidden" class="hidden" value="question_id" name="question_id"> -->
            <div class="form-group {% if form.meal_number.errors %}has-warning has-feedback{% endif %}" >
              <label for="{{ form.meal_number.id_for_label }}" class="control-label">Combien de repas souhaitez vous préparer ?</label>
              {{ form.meal_number }}
            </div>
            <div class="form-group {% if form.course_options.errors %}has-warning has-feedback{% endif %}">
              <label for="{{ form.course_options.id_for_label }}" class="control-label">Quel(s) plat(s) doivent figurer au menu de chaque repas ?</label>
              {{ form.course_options }}
            </div>
            <button type="submit" name="action" value="question" class="btn btn-success">C'est parti !</button>
        </form>
        {% if errors %}
          <div>
            {% for key, error in errors %}
            {% autoescape off %}
              {{ error }}
            {% endautoescape %}
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>
  </div>
  <hr>

  {% if meal_list|length != 0 %}

  <!-- Search Result -->
  <div class="container">
    <div class ="row">
      <div class="col-lg-12 col-md-12 text-center">
        <h2></h2>
      </div>
    </div>

    {% for meal in meal_list %}
    <h2>Menu n°{{ forloop.counter }}</h2>
    <div class="row meal-container">
      {% for recipe in meal %}
        {% if meal|length == 1 %} <div class="col-lg-8 col-md-8 mx-auto recipe-container" >
        {% elif meal|length == 2 %} <div class="col-lg-6 col-md-6 mx-auto recipe-container" >
        {% else %} <div class="col-lg-4 col-md-4 recipe-container" > {% endif %}
          <h3 class="text-center">{{ recipe.name }}</h3>
          <h5 class="text-center" style="color:#0085a1;">{{ recipe.get_type_display }}</h5>
          <h5>Ingrédients :</h5>
          {% for ri in recipe.recipeingredient_set.all %}
            <p>{{ ri.ingredient.name }}{% if ri.quantity %} : {{ ri.quantity|floatformat }} {{ ri.ingredient.unit }}{% endif %}</p>
          {% endfor %}
          <h5>Instructions :</h5>
          <p>{{ recipe.directions|safe }}</p>
          <i class="fa fa-repeat">Trouver une autre recette</i>
          {% if recipe.pdf_file %}
          <i class="fa fa-download"  id="{{ recipe.pdf_file }}">
            <input type="hidden" name="variable" value="{{ recipe.id }}">
            Télécharger la recette
          </i>
          {% endif %}
          </div>
      {% endfor %}
    </div>

    {% endfor %}
  </div>

  {% endif %}

{% endblock %}